# AI Expert System v2.0

ä¸€å€‹åŸºæ–¼ RAG (Retrieval-Augmented Generation) çš„ä¼æ¥­ç´šçŸ¥è­˜ç®¡ç†å°ˆå®¶ç³»çµ±ï¼Œæ”¯æ´å¤šæ ¼å¼æ–‡ä»¶è§£æã€çŸ¥è­˜åº«åˆ†é¡ç®¡ç†èˆ‡æ™ºæ…§å•ç­”ã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½

### 1. å¤šæ ¼å¼æ–‡ä»¶æ”¯æ´
- **æ”¯æ´æ ¼å¼**ï¼šPPTX, Markdown, Text, PDF
- **è‡ªå‹•è§£æ**ï¼šæ™ºæ…§æå–æ–‡å­—ã€è¡¨æ ¼èˆ‡åœ–ç‰‡å…§å®¹
- **çµæ§‹åŒ–è™•ç†**ï¼šå°‡éçµæ§‹åŒ–æ–‡ä»¶è½‰ç‚ºçµæ§‹åŒ–çŸ¥è­˜å–®å…ƒ

### 2. å°ˆæ¥­çŸ¥è­˜åˆ†é¡ (v2.0 æ¶æ§‹)
ç³»çµ±æ”¯æ´å››ç¨®å°ˆå±¬æ–‡ä»¶é¡å‹ï¼Œé‡å°ä¸åŒå ´æ™¯å„ªåŒ–ï¼š
- **ï¿½ çŸ¥è­˜åº« (Knowledge)**ï¼šæŠ€è¡“æ–‡ä»¶ã€æ‰‹å†Šã€æ•™ç§‘æ›¸ (è‘—é‡ç« ç¯€çµæ§‹)
- **ğŸ“ æ•™è‚²è¨“ç·´ (Training)**ï¼šåŸ¹è¨“æ•™æã€èª²ç¨‹è¬›ç¾© (è‘—é‡é‡é»æ‘˜è¦)
- **ï¿½ æ—¥å¸¸æ‰‹é † (Procedure)**ï¼šSOPã€æ“ä½œæ‰‹å†Š (è‘—é‡æ­¥é©Ÿåˆ†è§£)
- **ï¿½ ç•°å¸¸è§£æ (Troubleshooting)**ï¼š8D å ±å‘Šã€ç¶­ä¿®è¨˜éŒ„ (è‘—é‡å•é¡Œåˆ†æèˆ‡è§£æ±ºå°ç­–)

### 3. é›™ä»‹é¢è¨­è¨ˆ
- **âš™ï¸ ç®¡ç†å¾Œå° (Admin Console)**ï¼šæ–‡ä»¶ä¸Šå‚³ã€è§£æç‹€æ…‹ç›£æ§ã€è³‡æ–™åº«ç®¡ç†ã€Token ä½¿ç”¨çµ±è¨ˆ
- **ï¿½ å°ˆå®¶å•ç­” (Chat Expert)**ï¼šæ™ºæ…§æœå°‹ã€å¤šè¼ªå°è©±ã€æ¨¡ç³Šæ¯”å°ç³¾éŒ¯ã€è‡ªå‹•èƒå–é—œéµå­—

### 4. æ™ºæ…§æœå°‹å¼•æ“
- **å¤šå±¤ç´šé™ç´šæœå°‹**ï¼šæª”åæœå°‹ -> é—œéµå­—æœå°‹ -> æ‘˜è¦æœå°‹ -> å…¨æ–‡æœå°‹
- **æ™ºæ…§èƒå–**ï¼šè‡ªå‹•å¾è‡ªç„¶èªè¨€ä¸­æå–æª”åæˆ–ç·¨è™Ÿ (å¦‚ "N706 è´è¶Mura")
- **æ¨¡ç³Šæœå°‹**ï¼šå®¹å¿æ‹¼å¯«éŒ¯èª¤ï¼Œæå‡æœå°‹å‘½ä¸­ç‡

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å®‰è£ä¾è³´

```bash
pip install -r requirements.txt
```

### 2. ç’°å¢ƒè¨­å®š

è¤‡è£½ `.env.example` ç‚º `.env` ä¸¦å¡«å…¥æ‚¨çš„è¨­å®š (æˆ–ç›´æ¥åœ¨ UI è¨­å®š)ï¼š

```bash
cp .env.example .env
```

### 3. å•Ÿå‹•ç³»çµ±

æœ¬ç³»çµ±åˆ†ç‚ºå…©å€‹ç¨ç«‹ä»‹é¢ï¼Œè«‹ä¾éœ€æ±‚å•Ÿå‹•ï¼š

**å•Ÿå‹•ç®¡ç†å¾Œå° (Port 8501)**
```bash
streamlit run admin_app.py
```
ç”¨é€”ï¼šä¸Šå‚³æ–‡ä»¶ã€ç®¡ç†è³‡æ–™åº«ã€æŸ¥çœ‹çµ±è¨ˆå ±è¡¨ã€‚

**å•Ÿå‹•å•ç­”ä»‹é¢ (Port 8502)**
```bash
streamlit run chat_app.py --server.port 8502
```
ç”¨é€”ï¼šä¸€èˆ¬ä½¿ç”¨è€…é€²è¡ŒæŸ¥è©¢èˆ‡å•ç­”ã€‚

---

## ğŸ“– ä½¿ç”¨æµç¨‹

### Step 1: å»ºç«‹çŸ¥è­˜åº« (ç®¡ç†å¾Œå°)
1. é€²å…¥ **ç®¡ç†å¾Œå°** (`admin_app.py`)
2. åœ¨ã€Œæ–‡ä»¶ä¸Šå‚³ã€é ç±¤ï¼Œå»ºç«‹æ–‡ä»¶åˆ†é¡ (å¦‚ï¼šç•°å¸¸è§£æ)
3. è¼¸å…¥è³‡æ–™å¤¾è·¯å¾‘ï¼Œç³»çµ±æœƒè‡ªå‹•æƒæä¸¦è§£ææ‰€æœ‰æ”¯æ´çš„æª”æ¡ˆ
4. ç­‰å¾…è™•ç†å®Œæˆ

### Step 2: æŸ¥è©¢çŸ¥è­˜ (å•ç­”ä»‹é¢)
1. é€²å…¥ **å°ˆå®¶å•ç­”** (`chat_app.py`)
2. (å¯é¸) åœ¨å´é‚Šæ¬„é™å®šæœå°‹ç¯„åœ (å¦‚ï¼šåªæœ "ç•°å¸¸è§£æ")
3. è¼¸å…¥å•é¡Œï¼Œä¾‹å¦‚ï¼šã€Œè«‹æ­¸ç´ N706 çš„ç•°å¸¸åŸå› ã€
4. ç³»çµ±å°‡åˆ—å‡ºåƒè€ƒæ–‡ä»¶ä¸¦ç”Ÿæˆ AI å›ç­”

---

## ğŸ› ï¸ æŠ€è¡“æ¶æ§‹

### ç³»çµ±æ¨¡çµ„é—œä¿‚åœ– (System Architecture)

```mermaid
graph TD
    User((User))
    Admin((Admin))

    subgraph Frontend [å‰ç«¯ä»‹é¢ - Streamlit]
        ChatApp[chat_app.py<br>å°ˆå®¶å•ç­”]
        AdminApp[admin_app.py<br>å¾Œå°ç®¡ç†]
    end

    subgraph Core [æ ¸å¿ƒé‚è¼¯ - /core]
        Search[search_v2.py<br>æ™ºæ…§æœå°‹å¼•æ“]
        Ingestion[ingestion.py<br>æ–‡ä»¶æ”å–æµç¨‹]
        AICore[ai_core.py<br>LLM ä»‹é¢]
        DB[database.py<br>è³‡æ–™åº«å­˜å–]
    end

    subgraph Parsers [è§£ææ¨¡çµ„]
        Dispatcher[parsers.py<br>è§£ææ´¾ç™¼å™¨]
        PPT[ppt_parser.py]
        MD[md_parser.py]
    end

    subgraph Data [è³‡æ–™å„²å­˜ - /data]
        KB[(knowledge.db<br>çŸ¥è­˜åº«)]
        TokenDB[(token_usage.db<br>Token è¨˜éŒ„)]
    end

    User --> ChatApp
    Admin --> AdminApp

    ChatApp --> Search
    ChatApp --> DB
    ChatApp --> AICore

    AdminApp --> Ingestion
    AdminApp --> DB

    Ingestion --> Dispatcher
    Dispatcher --> PPT
    Dispatcher --> MD
    Ingestion --> DB
    Ingestion --> AICore

    Search --> DB
    Search --> AICore

    DB --> KB
    DB --> TokenDB
```

### å°ˆæ¡ˆç›®éŒ„çµæ§‹ (File Structure)

```
ppt_expert_system/
â”œâ”€â”€ admin_app.py           # ç®¡ç†å¾Œå°ï¼šè² è²¬æ–‡ä»¶ä¸Šå‚³ã€è§£ææ’ç¨‹èˆ‡ç³»çµ±è¨­å®š
â”œâ”€â”€ chat_app.py            # å•ç­”å‰å°ï¼šè² è²¬ä½¿ç”¨è€…å°è©±ã€æœå°‹èˆ‡ AI å›ç­”ç”Ÿæˆ
â”œâ”€â”€ config.py              # å…¨åŸŸé…ç½®ï¼šç’°å¢ƒè®Šæ•¸ã€è·¯å¾‘è¨­å®šã€Log è¨­å®š
â”‚
â”œâ”€â”€ core/                  # æ ¸å¿ƒæ¨¡çµ„
â”‚   â”œâ”€â”€ database.py        # è³‡æ–™å­˜å–å±¤ (DAL)ï¼šçµ±ä¸€è™•ç† SQLite CRUD æ“ä½œ
â”‚   â”œâ”€â”€ search_v2.py       # æª¢ç´¢å±¤ (Retrieval)ï¼šå¯¦ä½œå¤šå±¤ç´šé™ç´šæœå°‹èˆ‡æ¨¡ç³Šæ¯”å°
â”‚   â”œâ”€â”€ ingestion.py       # æ”å–å±¤ (Ingestion)ï¼šå”èª¿æª”æ¡ˆæƒæã€è§£æèˆ‡å¯«å…¥æµç¨‹
â”‚   â”œâ”€â”€ ai_core.py         # AI ä»‹é¢å±¤ï¼šå°è£ OpenAI/Compatible API å‘¼å«
â”‚   â”‚
â”‚   # è§£æå™¨æ¨¡çµ„ (Parsers)
â”‚   â”œâ”€â”€ parsers.py         # è§£ææ´¾ç™¼å™¨ (Factory)ï¼šæ ¹æ“šå‰¯æª”åé¸æ“‡è§£æç­–ç•¥
â”‚   â”œâ”€â”€ ppt_parser.py      # PPT è§£æå™¨ï¼šæå–æŠ•å½±ç‰‡æ–‡å­—ã€è¡¨æ ¼èˆ‡åœ–ç‰‡
â”‚   â””â”€â”€ md_parser.py       # Markdown è§£æå™¨ï¼šè§£æç« ç¯€çµæ§‹èˆ‡å…§å®¹
â”‚
â””â”€â”€ data/                  # è³‡æ–™èˆ‡æ—¥èªŒ
    â”œâ”€â”€ knowledge.db       # ä¸»è¦çŸ¥è­˜åº« (Documents + 4ç¨®å­è¡¨)
    â”œâ”€â”€ token_usage.db     # Token æ¶ˆè€—è¨˜éŒ„ (ç¨ç«‹å„²å­˜ä»¥åˆ©çµ±è¨ˆ)
    â””â”€â”€ temp_images/       # åœ–ç‰‡æš«å­˜ (ç”¨æ–¼ Vision API åˆ†æ)
```

## ğŸ“ ç‰ˆæœ¬è³‡è¨Š
**v2.0.0**
- æ¶æ§‹é‡æ§‹ï¼šæ‹†åˆ†ç‚º Admin/Chat é›™ä»‹é¢
- è³‡æ–™åº«å‡ç´šï¼šæ”¯æ´ Knowledge/Training/Procedure/Troubleshooting å››å¤§åˆ†é¡
- æœå°‹å¼•æ“å‡ç´šï¼šæ–°å¢æª”åæœå°‹ã€æ™ºæ…§é—œéµå­—èƒå–ã€æ¨¡ç³Šæ¯”å°
- æ”¯æ´æ›´å¤šæ ¼å¼ï¼šæ–°å¢ PDF æ”¯æ´
